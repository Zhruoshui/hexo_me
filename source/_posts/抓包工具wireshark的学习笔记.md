---
title: æŠ“åŒ…å·¥å…·wiresharkçš„å­¦ä¹ ç¬”è®°
description: "ç½‘ç»œåŒ…åˆ†æå·¥å…·"
abbrlink: 26256
date: 2024-03-21 13:41:03
cover: https://image.aruoshui.fun/i/2024/12/31/vsjb7w-0.webp
tags:
  - æŠ“åŒ…
  - å¸¸ç”¨ç½‘ç»œåè®®
categories:
  - å¼€å‘æŠ€èƒ½ 
---

{% timeline è·Ÿè¸ªæ—¥å¿—,blue %}

<!-- timeline 2024/3/17 -->
wiresharkçš„å®‰è£…å’ŒåŸºç¡€ä½¿ç”¨
<!-- endtimeline -->

<!-- timeline 2024/3/27 -->
å¸¸è§åè®®çš„æŠ“åŒ…åˆ†æ
<!-- endtimeline -->


{% endtimeline %}

# å‚è€ƒæ–‡ç« 
{% link ç½‘ç»œå®‰å…¨å·¥å…·â€”â€”WiresharkæŠ“åŒ…å·¥å…·, https://blog.csdn.net/p36273/article/details/130800459, https://blog.csdn.net/weixin_43603658/article/details/130236856 %}



<div align=center class="aspect-ratio">
    <iframe src="//player.bilibili.com/player.html?aid=524106622&bvid=BV1YM411Y7oU&cid=1000587951&p=1" 
    scrolling="no" 
    border="0" 
    frameborder="no" 
    framespacing="0" 
    high_quality=1
    danmaku=1 
    allowfullscreen="true"> 
    </iframe>
</div>



# WiresharkæŠ“åŒ…å…¥é—¨æ“ä½œ
## å¸¸è§åè®®åŒ…
[ARPåè®®](https://blog.csdn.net/weixin_58783105/article/details/134986414?spm=1001.2101.3001.6650.1&utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7ECTRLIST%7ERate-1-134986414-blog-131233662.235%5Ev43%5Epc_blog_bottom_relevance_base7&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7ECTRLIST%7ERate-1-134986414-blog-131233662.235%5Ev43%5Epc_blog_bottom_relevance_base7&utm_relevant_index=2)
[ICMPåè®®](https://blog.csdn.net/zy_dreamer/article/details/132509931)
[TCPåè®®](https://zhuanlan.zhihu.com/p/603382668?utm_id=0)
[UDPåè®®](https://zhuanlan.zhihu.com/p/357080855)
[DNSåè®®](https://www.zhihu.com/question/23099454/answer/3197458866)
[HTTPåè®®](https://blog.csdn.net/lfm1010123/article/details/126293176)

## æŸ¥çœ‹æœ¬æœºè¦æŠ“åŒ…çš„ç½‘ç»œ
cmdè¾“å…¥æŒ‡ä»¤ipconfigæ‰¾åˆ°å¯¹åº”çš„ç½‘ç»œ

## wiresharkçš„æ··æ‚æ¨¡å¼
æ··æ‚æ¨¡å¼æ¦‚è¿°:æ··æ‚æ¨¡å¼å°±æ˜¯æ¥æ”¶æ‰€æœ‰ç»è¿‡ç½‘å¡çš„æ•°æ®åŒ…ï¼ŒåŒ…æ‹¬ä¸æ˜¯å‘ç»™æœ¬æœºçš„åŒ…ï¼Œå³ä¸éªŒè¯MACåœ°å€ã€‚æ™®é€šæ¨¡å¼ä¸‹ç½‘å¡åªæ¥æ”¶å‘ç»™æœ¬æœºçš„åŒ…ï¼ˆåŒ…æ‹¬å¹¿æ’­åŒ…ï¼‰ä¼ é€’ç»™ä¸Šå±‚ç¨‹åºï¼Œå…¶å®ƒçš„åŒ…ä¸€å¾‹ä¸¢å¼ƒã€‚
![](https://s2.loli.net/2024/03/21/nhABoVcsGxSL5If.jpg)


## Wiresharkè¿‡æ»¤å™¨ä½¿ç”¨

### wiresharkå¸¸ç”¨è¿‡æ»¤æ¡ä»¶
1. å¸¸ç”¨æ¡ä»¶
```bash
â€˜eqâ€™å’Œâ€™==â€™ ç­‰åŒ
and å¹¶ä¸”
or æˆ–è€…
â€˜!â€™ å’Œâ€™notâ€™ å–å
```

2. é’ˆå¯¹IPåœ°å€è¿‡æ»¤
```bash
1.æºåœ°å€ï¼šip.src == 192.168â€¦
2.ç›®çš„åœ°å€ï¼šip.dst == 192.168.xx
3.ä¸çœ‹æºæˆ–ç›®çš„åœ°å€ï¼šip.addr == 192.168.xx
```
3. é’ˆå¯¹åè®®è¿‡æ»¤
```bash
1.æŸç§åè®®çš„æ•°æ®åŒ… ç›´æ¥è¾“å…¥åè®®åå­—
å¦‚ï¼šhttp
2.æ’é™¤æŸç§åè®®
not tcp æˆ–è€… ï¼tcp
```
4. é’ˆå¯¹ç«¯å£è¿‡æ»¤
```bash
1.æ•è·æŸç«¯å£çš„æ•°æ®åŒ…
tcp.port == 80
tcp.srcport == 80
tcp.dstport == 80
2.æ•è·å¤šç«¯å£
udp.port >=2048
```

5. é’ˆå¯¹é•¿åº¦å’Œå†…å®¹è¿‡æ»¤
```bash
1.é•¿åº¦è¿‡æ»¤
data.len > 0
udp.lenth < 30
http.content_lenth <= 20
2.æ•°æ®åŒ…å†…å®¹è¿‡æ»¤
http.request.uri matches â€œvipscuâ€(åŒ¹é…httpè¯·æ±‚ä¸­å«æœ‰vipscuå­—æ®µçš„è¯·æ±‚ä¿¡æ¯)
```

### å¼€å¯æ··æ·†æ¨¡å¼ï¼ŒæŠ“å–æ¥å£ä¸Šä½¿ç”¨æ··æ‚æ¨¡å¼ç›´æ¥è¿›è¡ŒæŠ“åŒ…
![](https://s2.loli.net/2024/03/26/DP2nJ5WewyYztEM.png)

## arpåè®®åˆ†æ
ARPï¼ˆAddress Resolution Protocolï¼‰åè®®å·¥ä½œåœ¨ç½‘ç»œå±‚å’Œæ•°æ®é“¾è·¯å±‚ä¹‹é—´ï¼Œé€šå¸¸è¢«è®¤ä¸ºæ˜¯ä¸€ä¸ªè·¨ä¸¤å±‚çš„åè®®ã€‚ç®€å•æ¥è¯´ï¼Œå®ƒå°±åƒæ˜¯ä¸€æœ¬â€œç¿»è¯‘è¯å…¸â€ï¼Œå¸®åŠ©ä½ çš„ç”µè„‘å°†IPåœ°å€â€œç¿»è¯‘â€æˆMACåœ°å€ï¼Œè¿™æ ·ä½ çš„ç”µè„‘æ‰èƒ½åœ¨ç½‘ä¸Šå’Œå…¶ä»–è®¾å¤‡è¿›è¡Œé€šä¿¡ã€‚

![](https://s2.loli.net/2024/03/26/15GyJuRzl6SXY47.png)

### æŠ“åŒ…åˆ†æ

#### æ•°æ®åŒ…æ ¼å¼

![ARPæ•°æ®åŒ…çš„æ ¼å¼](https://s2.loli.net/2024/03/26/bFTZIovByQpcj18.png)

è¯´æ˜ï¼š
{% note info modern %}
1. Hardware Typeï¼šè¡¨ç¤ºç¡¬ä»¶åœ°å€ç±»å‹ï¼Œä¸€èˆ¬ä¸ºMACåœ°å€ã€‚å®ƒçš„å€¼ä¸º1è¡¨ç¤ºä»¥å¤ªç½‘åœ°å€ã€‚
2. Protocol Typeï¼šè¡¨ç¤ºä¸‰å±‚åè®®åœ°å€ç±»å‹ï¼Œä¸€èˆ¬ä¸ºIPã€‚å®ƒçš„å€¼ä¸º0x0800å³è¡¨ç¤ºIPåœ°å€ã€‚å®ƒçš„å€¼ä¸åŒ…å«IPæ•°æ®æŠ¥çš„ä»¥å¤ªç½‘æ•°æ®å¸§ä¸­çš„ç±»å‹å­—æ®µçš„å€¼ç›¸åŒã€‚
3. Hardware Lengthå’ŒProtocol Lengthï¼šè¡¨ç¤ºMACåœ°å€å’ŒIPåœ°å€çš„é•¿åº¦ï¼Œå•ä½æ˜¯å­—èŠ‚ã€‚å€¼åˆ†åˆ«æ˜¯6å’Œ4ã€‚(6 * 8bit=48bitï¼Œ4 * 8bit = 32bit)
4. Operation Codeï¼šæŒ‡å®šäº†ARPæŠ¥æ–‡çš„ç±»å‹ï¼ŒåŒ…æ‹¬ARP Requestå’ŒARP Replyã€‚ï¼ˆ1ä¸ºARPè¯·æ±‚ï¼Œ2ä¸ºARPåº”ç­”ï¼‰
5. Source Hardware Addressï¼šæŒ‡çš„æ˜¯å‘é€ARPæŠ¥æ–‡çš„è®¾å¤‡MACåœ°å€ï¼ˆæºMACåœ°å€ï¼‰
6. Source Protocol Addressï¼šæŒ‡çš„æ˜¯å‘é€ARPæŠ¥æ–‡çš„è®¾å¤‡IPåœ°å€ï¼ˆæºIPåœ°å€ï¼‰ã€‚
7. Destination Hardware Addressï¼šæŒ‡çš„æ˜¯æ¥æ”¶è€…MACåœ°å€ï¼Œåœ¨ARP RequestæŠ¥æ–‡ä¸­ï¼Œè¯¥å­—æ®µå€¼ä¸º0ï¼ˆç›®çš„MACåœ°å€ï¼‰ã€‚
8. Destination Protocol Addressï¼šæŒ‡çš„æ˜¯æ¥æ”¶è€…çš„IPåœ°å€ï¼ˆç›®çš„MACåœ°å€ï¼‰ã€‚
{% endnote %}

##### ARP Reply å“åº”åŒ…
å‘ä¸Šè¾¹çš„å›¾ç‰‡å°±æ˜¯ä¸€ä¸ªARP Reply å“åº”åŒ…

##### ARP Request è¯·æ±‚åŒ…
![ARP Request è¯·æ±‚åŒ…](https://s2.loli.net/2024/03/26/KSibOdGtvWDY19N.png)

##### ARP ç¼“å­˜
å½“ç„¶å¦‚æœæ¯æ¬¡éƒ½éœ€è¦è¿™æ ·ä¸€ä¸ªæ˜ å°„æ˜¾ç„¶æ•ˆç‡ä½ä¸‹ï¼Œäºæ˜¯ä¾¿æœ‰äº†ARPç¼“å­˜ã€‚{% emp æ¥å­˜æ”¾IPåœ°å€å’ŒMACåœ°å€å…³è”ä¿¡æ¯ %}
å‘é€ä¿¡æ¯å‰ï¼ŒæŸ¥æ‰¾ARPç¼“å­˜è¡¨ï¼Œå­˜åœ¨å¯¹æ–¹MACåœ°å€ï¼Œç›´æ¥å°è£…æˆå¸§ã€‚
- å¦‚æœä¸å­˜åœ¨ï¼Œé€šè¿‡å‘é€ ARP RequestæŠ¥æ–‡è·å–å¯¹æ–¹MACåœ°å€ã€‚
- å¦‚æœç›®æ ‡åœ¨å…¶ä»–ç½‘ç»œï¼Œæºè®¾å¤‡ä¼šå…ˆæŸ¥æ‰¾ç½‘å…³MACåœ°å€ï¼Œå°†æ•°æ®å‘ç»™ç½‘å…³ï¼Œå†è½¬å‘ã€‚
- IPå’ŒMACå…³ç³»æ˜ å°„å…³ç³»ä¼šæ”¾å…¥ARPç¼“å­˜è¡¨ä¸€æ®µæ—¶é—´ï¼Œæœ‰æ•ˆæœŸå†…éƒ½å¯æŸ¥åˆ°ï¼Œè¿‡äº†è¿™ä¸ªæœ‰æ•ˆæœŸä¼šè‡ªåŠ¨åˆ é™¤ã€‚

##### ARPçš„è¯·æ±‚ã€å“åº”ã€ä»£ç†ã€IPå†²çª
è¿™äº›ç‚¹è¯·è¯¦è§ï¼š
{% note info flat %}å‚è€ƒï¼š[ARPçš„è¯·æ±‚ã€å“åº”ã€ä»£ç†ã€IPå†²çª](https://blog.csdn.net/weixin_58783105/article/details/134986414?spm=1001.2101.3001.6650.1&utm_medium=distribute.pc_relevant.none-task-blog-2~default~CTRLIST~Rate-1-134986414-blog-131233662.235%5Ev43%5Epc_blog_bottom_relevance_base7&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~CTRLIST~Rate-1-134986414-blog-131233662.235%5Ev43%5Epc_blog_bottom_relevance_base7&utm_relevant_index=2){% endnote %}

è¿™ä¸ªåšä¸»çš„ä¾‹å­å¾ˆè¯¦ç»†æ¸…æ¥šï¼Œæˆ‘ä¹Ÿä¸æŠ„ä¸€éäº†ã€‚


#### ARPå­˜åœ¨ä¸€ä¸ªARPæ¬ºéª—çš„é—®é¢˜
ç®€å•ç†è§£å°±æ˜¯ä½¿å¾—ç›®æ ‡ä¸»æœºæ¥æ”¶é”™è¯¯çš„IPå’ŒMACç»‘å®šå…³ç³»
æ”»å‡»è€…å¯ä»¥å‘é€è™šå‡çš„ARPè¯·æ±‚æˆ–åº”ç­”æŠ¥æ–‡ï¼Œä½¿å¾—ç›®æ ‡ä¸»æœºæ¥æ”¶é”™è¯¯çš„IPå’ŒMACç»‘å®šå…³ç³»ã€‚é‚£ä¹ˆå‘é€ç»™ç›®æ ‡çš„æ•°æ®å°±ä¸å†èµ°ç½‘å…³äº†ï¼Œè€Œæ˜¯åˆ°æ”»å‡»è€…é‚£é‡Œã€‚å¦‚æœæ”»å‡»è€…æ‹¦æˆªæ•°æ®åŒ…ä¸è¿›è¡Œè½¬å‘çš„è¯ï¼Œæœ¬æœºå°±ä¼šæ–­ç½‘ã€‚

{% note info flat %}å‚è€ƒï¼š[æ›´å¤šè¯¦ç»†ä¿¡æ¯è¯·è§](https://blog.csdn.net/weixin_58783105/article/details/134986414?spm=1001.2101.3001.6650.1&utm_medium=distribute.pc_relevant.none-task-blog-2~default~CTRLIST~Rate-1-134986414-blog-131233662.235%5Ev43%5Epc_blog_bottom_relevance_base7&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~CTRLIST~Rate-1-134986414-blog-131233662.235%5Ev43%5Epc_blog_bottom_relevance_base7&utm_relevant_index=2){% endnote %}



## ICMPåè®®åˆ†æ
### ICMPæ˜¯ä»€ä¹ˆ
ICMP çš„å…¨ç§°æ˜¯ Internet Control Message Protocol(äº’è”ç½‘æ§åˆ¶åè®®)ï¼Œå®ƒæ˜¯ä¸€ç§äº’è”ç½‘å¥—ä»¶ï¼Œå®ƒç”¨äºIP åè®®ä¸­ä¸­ä¼ é€’æ§åˆ¶ä¿¡æ¯å’Œé”™è¯¯æ¶ˆæ¯ã€‚

ICMPåè®®çš„ä¸»è¦åŠŸèƒ½å¦‚ä¸‹ï¼š
1. å‘ç°ç½‘ç»œé”™è¯¯ï¼šå½“ä¸€ä¸ªæ•°æ®åŒ…åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­å‡ºç°é”™è¯¯æ—¶ï¼ŒICMPåè®®é€šè¿‡å‘å‘é€æ–¹å‘é€é”™è¯¯é€šçŸ¥æ¥å‘ç°ç½‘ç»œé”™è¯¯ã€‚
2. æ£€æŸ¥ç½‘ç»œæ˜¯å¦å¯è¾¾ï¼šé€šè¿‡å‘é€ICMP ECHOè¯·æ±‚å¹¶æ¥æ”¶ICMP ECHOå›å¤æ¶ˆæ¯ï¼Œå¯ä»¥ç¡®å®šç›®æ ‡ä¸»æœºæ˜¯å¦å¯è¾¾ã€‚
3. å‘ç°ä¸»æœºé”™è¯¯ï¼šå½“ä¸€ä¸ªä¸»æœºæ— æ³•æ­£å¸¸å·¥ä½œæ—¶ï¼ŒICMPåè®®é€šè¿‡å‘å‘é€æ–¹å‘é€é”™è¯¯é€šçŸ¥æ¥å‘ç°ä¸»æœºé”™è¯¯ã€‚
4. å‘é€è·¯ç”±ä¿¡æ¯ï¼šICMPåè®®å¯ä»¥å‘å…¶ä»–ä¸»æœºå‘é€è·¯ç”±ä¿¡æ¯ï¼Œä»¥å¸®åŠ©å®ƒä»¬åœ¨ç½‘ç»œä¸­æ‰¾åˆ°åˆé€‚çš„è·¯ç”±ã€‚

#### è¿‡ç¨‹
![é€šçŸ¥ç¤ºæ„å›¾](https://s2.loli.net/2024/03/26/lEe51a8wGVSQOHn.jpg)
åœ¨è¿™ä¸ªå›¾ä¸­ï¼š
{% note info modern %}
ä¸»æœº A æƒ³è¦ç»™ä¸»æœº B å‘é€ä¸€ä¸ª IP æ•°æ®åŒ…ï¼Œä¸»æœº A å‘é€çš„æ•°æ®åŒ…ç»è¿‡è·¯ç”±å™¨ 1 åˆ°è¾¾äº†è·¯ç”±å™¨ 2 ï¼Œç”±äºè·¯ç”±å™¨ 2 ä¸çŸ¥é“ä¸»æœº B çš„ MAC åœ°å€ï¼Œæ‰€ä»¥è·¯ç”±å™¨ 2 å‘é€äº†ä¸€ä¸ª ARP è¯·æ±‚ï¼Œæ²¡æœ‰å›åº”ï¼Œå†ç»è¿‡é‡è¯•æ—¶é—´åå†æ¬¡å‘é€ï¼Œè¿˜æ²¡æœ‰å›åº”ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ç»è¿‡å¤šæ¬¡ ARP è¯·æ±‚åæ²¡æœ‰å¾—åˆ°å›åº”åï¼Œè·¯ç”±å™¨ 2 å°±ä¼šç»™ä¸»æœº A å‘é€ä¸€ä¸ª ICMP æ¶ˆæ¯ï¼Œå‘Šè¯‰å…¶å‘é€çš„ IP æ•°æ®åŒ…æ²¡æœ‰åˆ°è¾¾ä¸»æœº B ã€‚
{% endnote %}

#### æŠ“åŒ…åˆ†æ
ç»å¸¸ä½¿ç”¨ ICMP æ•°æ®åŒ…çš„ä¸¤ä¸ªç»ˆç«¯ç¨‹åºæ˜¯ ping å’Œ tracerouteã€‚è¿™é‡Œæˆ‘pingäº†ä¸€ä¸‹æˆ‘çš„ç½‘å…³åœ°å€

##### è¯·æ±‚
![](https://s2.loli.net/2024/03/26/qB7OYsbeAnLDKhU.jpg)

##### å“åº”
![](https://s2.loli.net/2024/03/26/cO5n18fTqbzSELe.jpg)

å…¶ä¸­æ³¨æ„typeç±»å‹ï¼š
![é€šçŸ¥ç±»å‹](https://s2.loli.net/2024/03/26/JLHOoxMANk51vgK.jpg)
æˆ‘ä¸Šè¾¹çš„ä¸¤ä¸ªå°±å±äºå›é€è¯·æ±‚å’Œå›é€åº”ç­”(ç±»å‹ 8 å’Œ ç±»å‹ 0 )

##### å…¶ä»–ICMPæ¶ˆæ¯å’ŒIPv6çš„ICMPv6
å…¶ä»–æ¶ˆæ¯å’ŒICMPv6æˆ‘è¿™ä¸æ–¹ä¾¿æµ‹è¯•ï¼Œæƒ³äº†è§£çš„å¯ä»¥æŸ¥çœ‹ä¸‹è¾¹çš„é“¾æ¥ï¼š
{% note info flat %}å‚è€ƒï¼š[æ›´å¤šçš„ä¿¡æ¯è¯·ä½ æŸ¥çœ‹](https://blog.csdn.net/zy_dreamer/article/details/132509931){% endnote %}


## TCP
ç›¸ä¿¡å­¦è¿‡è®¡ç½‘éƒ½å¾ˆæ¸…æ¥šæ•´ä¸ªè¿‡ç¨‹ï¼Œè¿™é‡Œå°±ä¸è¯¦ç»†èµ˜è¿°äº†ï¼Œå¦‚æœæƒ³è¦äº†è§£æ‰€æœ‰çš„ç»†èŠ‚ï¼Œè¯·ä½ ç§»æ­¥ï¼š
{% note info flat %}å‚è€ƒï¼š[TCPè¯¦è§£](https://zhuanlan.zhihu.com/p/603382668?utm_id=0){% endnote %}

TCPæœ‰å¦‚ä¸‹çš„åè®®æ ¼å¼éœ€è¦æ¸…æ¥šï¼Œåœ¨æŠ“åŒ…æ—¶å¯ä»¥é’ˆå¯¹åˆ†æï¼š
{% note info modern %}
- 16ä½æºç«¯å£å·ï¼š æ•°æ®å‘é€æ–¹çš„ç«¯å£å·ï¼Œè¡¨ç¤ºæ•°æ®ä»å“ªé‡Œæ¥
- 16ä½ç›®æ ‡ç«¯å£å·ï¼šæ•°æ®æ¥æ”¶æ–¹çš„ç«¯å£å·ï¼Œè¡¨ç¤ºæ•°æ®è¦åˆ°å“ªé‡Œå»
- 32ä½åºå·ï¼šæ¯ä¸€æ¬¡é€šä¿¡TCPæŠ¥æ–‡çš„ç¼–å·
- 32ç¡®è®¤åºå·ï¼šç”¨äºå¯¹å‘é€æ–¹å‘é€çš„æŠ¥æ–‡çš„ç¡®è®¤ï¼Œä¸ºæ¥æ”¶åˆ°çš„æŠ¥æ–‡åºå·+1
- 4ä½é¦–éƒ¨é•¿åº¦ï¼šè¡¨ç¤ºTCPæŠ¥æ–‡å¤´éƒ¨æœ‰å¤šå°‘ä¸ª4å­—èŠ‚ï¼Œå› ä¸º4ä½æœ€å¤§è¡¨ç¤º15ï¼Œæ‰€ä»¥TCPæŠ¥æ–‡å¤´æœ€å¤§é•¿åº¦ä¸º15*4=60
- 6ä½æ ‡å¿—ä½ï¼š
URG: ç´§æ€¥æŒ‡é’ˆæ˜¯å¦æœ‰æ•ˆ
ACK: ç¡®è®¤åº”ç­”
PSH: æç¤ºæ¥æ”¶ç«¯åº”ç”¨ç¨‹åºç«‹åˆ»ä»TCPç¼“å†²åŒºæŠŠæ•°æ®è¯»èµ°
RST: è¡¨ç¤ºè¦æ±‚å¯¹æ–¹é‡æ–°å»ºç«‹è¿æ¥
SYN: è¯·æ±‚å»ºç«‹è¿æ¥ï¼Œæˆ‘ä»¬æŠŠæºå¸¦SYNæ ‡è¯†çš„ç§°ä¸ºåŒæ­¥æŠ¥æ–‡æ®µ
FIN: é€šçŸ¥å¯¹æ–¹æœ¬ç«¯è¦å…³é—­äº†ï¼Œæˆ‘ä»¬æŠŠæºå¸¦FINæ ‡è¯†çš„ä¸ºç»“æŸæŠ¥æ–‡æ®µ
- 16ä½çª—å£å¤§å°ï¼šTCPæµé‡æ§åˆ¶çš„ä¸€ä¸ªæ‰‹æ®µï¼Œè¿™é‡ŒæŒ‡æ¥æ”¶çª—å£ï¼Œç”¨äºå‘ŠçŸ¥å‘é€ç«¯æœ¬ç«¯çš„TCPç¼“å†²åŒºè¿˜èƒ½å®¹çº³å¤šå°‘å­—èŠ‚çš„æ•°æ®ï¼Œè¿™æ ·å‘é€æ–¹å°±å¯ä»¥æ§åˆ¶å‘é€çš„æ•°æ®é‡
- 16ä½æ ¡éªŒå’Œï¼šç”±å‘é€æ–¹å¡«å……ï¼Œæ¥æ”¶ç«¯å¯¹TCPæŠ¥æ–‡æ®µæ‰§è¡ŒCRCæ ¡éªŒä»¥æ£€æŸ¥æ•°æ®æ˜¯å¦æŸåï¼Œè¿™ä¸ªæ ¡éªŒä¸ä»…åŒ…å«TCPå¤´éƒ¨ï¼Œä¹ŸåŒ…å«æ•°æ®éƒ¨åˆ†
- 16ä½ç´§æ€¥æŒ‡é’ˆï¼šä¸€ä¸ªæ­£çš„åç§»é‡ï¼Œå®ƒä¸åºå·å­—æ®µç›¸åŠ è¡¨ç¤ºæœ€åä¸€ä¸ªç´§æ€¥æ•°æ®çš„ä¸‹ä¸€ä¸ªåºå·ï¼Œæ‰€ä»¥è¿™ä¸ªå­—æ®µæ˜¯ç´§æ€¥æŒ‡é’ˆç›¸å¯¹å½“å‰åºå·çš„åç§»ï¼Œç”¨äºå‘é€æ–¹å‘æ¥æ”¶æ–¹å‘é€ç´§æ€¥æ•°æ®
- 0-40å­—èŠ‚é€‰é¡¹æ•°æ®ï¼šå­˜å‚¨ä¸€äº›å¯èƒ½éœ€è¦çš„é¢å¤–ä¿¡æ¯
{% endnote %}

### TCPä¸‰æ¬¡æ¡æ‰‹è¿‡ç¨‹
![](https://s2.loli.net/2024/03/26/PoaYF6ZewhHqtCT.jpg)
#### æŠ“åŒ…åˆ†æ
{% note warning flat %}ç”¨åˆ°TCPçš„åœ°æ–¹å¤ªå¤šäº†ï¼Œå¾ˆä¸å®¹æ˜“ä¸“é—¨æ‰¾ä¸€ä¸ªç­‰å¾…å»ºç«‹è¿æ¥çš„ç‚¹ï¼Œè¿™ä¸ªæ—¶å€™æƒ³åˆ°äº†ä¹‹å‰å†™çš„SSHçš„ä¸€ç¯‡æ–‡ç« ï¼š[ä¸SSHçš„ä»Šç”Ÿä»Šä¸–ğŸ˜…](https://www.aruoshui.fun/posts/12699.html) äºæ˜¯è€ƒè™‘åœ¨è¿æ¥æœåŠ¡å™¨æˆ–è€…è™šæ‹Ÿæœºçš„æ—¶å€™è¿›è¡ŒæŠ“åŒ…ï¼Œæœç„¶æˆåŠŸäº†ã€‚{% endnote %}

ä»¥ä¸‹æ˜¯å¯¹ipï¼š192.168.131.138çš„ä¸€å°è™šæ‹Ÿæœºè¿æ¥çš„æŠ“åŒ… 

![](https://s2.loli.net/2024/03/27/di9PtJzYKoaVhC1.png)
å…¶ä¸­å¯ä»¥éå¸¸æ˜æ˜¾çš„çœ‹åˆ°TCPè¿æ¥è¿‡ç¨‹ä¸­å¦‚`SYN`ï¼Œ`ACK`ç­‰ï¼Œå…¶å®å˜ç›¸å¸®åŠ©ç†è§£TCPåè®®äº†ï¼Œæ¯”ä¹‹å‰ä¸Šå®éªŒè¯¾é‚£ä¸ªè¿‡ç¨‹å¥½å¤ªå¤šäº†ã€‚

#### è¿æ¥è¯·æ±‚
![è¿æ¥è¯·æ±‚](https://s2.loli.net/2024/03/27/IkuzirSglhtOyA8.png)
å¯ä»¥çœ‹åˆ°`Src Port`æ˜¯æœ¬æœºç”¨æ¥ç›‘å¬çš„ç«¯å£ï¼ˆéšæœºï¼‰ï¼Œè€Œè™šæ‹Ÿæœºä¸­SSHè¿æ¥å¼€æ”¾çš„ç«¯å£ `Dst Port` æ˜¯`22` 

#### è¿æ¥è¯·æ±‚ç¡®è®¤
![è¿æ¥è¯·æ±‚ç¡®è®¤](https://s2.loli.net/2024/03/27/2TDqpjCF8Vsu1UL.png) 

#### ç¡®è®¤
![ç¡®è®¤](https://s2.loli.net/2024/03/27/Ro5ByXTtDb31kaC.png)

#### åˆ©ç”¨wiresharkè‡ªå¸¦çš„æµé‡å›¾å·¥å…·è·å¾—TCPè¿æ¥è¿‡ç¨‹
åœ¨ç»Ÿè®¡ä»»åŠ¡æ ä¸­é€‰æ‹©æµé‡å›¾ï¼Œç‚¹å‡»ä¹‹åæµç±»å‹é€‰æ‹©ä¸ºTCPæµï¼Œå°±å¯ä»¥æ›´åŠ æ¸…æ™°çš„äº†è§£æ•´ä¸ªè¿‡ç¨‹äº†
![æµé‡å›¾](https://s2.loli.net/2024/03/27/qQ7gTbxuRGLN3fI.png)



### TCPè¿æ¥æ–­å¼€çš„å››æ¬¡æŒ¥æ‰‹
åŒæ ·çš„æ–­å¼€è¿æ¥æˆ‘è¿™é‡Œè¿˜æ˜¯åˆ©ç”¨è™šæ‹Ÿæœº
![](https://s2.loli.net/2024/03/27/SdOQf4YEXqsP8FA.png)
ç»†èŠ‚å°±ä¸åˆ†æäº†ï¼š
![](https://s2.loli.net/2024/03/27/7T9eDZPdvb4LUIN.png)
![](https://s2.loli.net/2024/03/27/Dn5vGcP28sulzNo.png)

## HTTPåè®®
### ä»€ä¹ˆæ˜¯HTTPåè®®
HTTP åè®®ç®€å•æ¥è¯´å°±æ˜¯å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ä¹‹é—´ä¸€å‘ä¸€æ”¶çš„æ¨¡å‹
![HTTPåè®®çš„æ ¸å¿ƒè¿‡ç¨‹](https://s2.loli.net/2024/03/27/POgYUjucWlDAmx1.jpg)
### HTTPåè®®çš„æŠ“åŒ…åˆ†æ
è¿™é‡Œåˆ©ç”¨`curl -I baidu.com`è®¿é—®ç™¾åº¦ç½‘ç«™ï¼Œè§¦å‘HTTPåè®®
![](https://s2.loli.net/2024/03/27/hoEgIiAmXPdD5x6.png)
#### å»ºç«‹TCPè¿æ¥
è¿™é‡Œå°±ä¸è¿‡å¤šèµ˜è¿°
#### è¯·æ±‚æŠ¥æ–‡å’Œå“åº”æŠ¥æ–‡
åœ¨è¯·æ±‚å’Œå“åº”éƒ¨åˆ†ï¼š
ç¬¬ä¸€ä¸ªåŒ…æ˜¯ï¼Œ`æˆ‘`å‘`ç™¾åº¦`å‘é€äº†ä¸€ä¸ªã€ŒHTTPè¯·æ±‚ã€ï¼Œè¯·æ±‚ç±»å‹æ˜¯HEAD
ç¬¬ä¸‰ä¸ªåŒ…æ˜¯ï¼Œ`ç™¾åº¦`å‘`æˆ‘`å‘é€äº†ä¸€ä¸ªã€ŒHTTPå“åº”ã€ï¼Œå“åº”çŠ¶æ€ç æ˜¯ 200 OK
#### é‡Šæ”¾è¿æ¥
è¿™é‡Œä¹Ÿä¸è¿‡å¤šèµ˜è¿°

#### åˆ†æHTTPåè®®æŠ¥æ–‡
è¯·æ±‚æŠ¥æ–‡åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†ï¼šè¯·æ±‚è¡Œã€è¯·æ±‚å¤´ã€è¯·æ±‚ä½“
å“åº”æŠ¥æ–‡åˆ†ä¸ºå››ä¸ªéƒ¨åˆ†ï¼šçŠ¶æ€è¡Œã€å“åº”å¤´ã€å“åº”ç©ºè¡Œã€å“åº”ä½“

##### è¯·æ±‚æŠ¥æ–‡
![](https://s2.loli.net/2024/03/27/KZon164DcXCtbsN.png)
è¯·æ±‚è¡Œï¼šåŒ…å«è¯·æ±‚æ–¹æ³•ã€è¯·æ±‚URLã€HTTPç‰ˆæœ¬
è¯·æ±‚å¤´ï¼šåŒ…å«è¯·æ±‚çš„å®¢æˆ·ç«¯çš„ä¿¡æ¯ï¼Œä¸€è¡Œä¸€ä¸ªè¯·æ±‚å¤´
è¯·æ±‚ä½“ï¼šPOSTç­‰ç±»å‹çš„è¯·æ±‚æ‰æœ‰è¯·æ±‚ä½“ï¼Œè¿™é‡Œæ²¡æœ‰

ç‚¹å¼€è¯·æ±‚è¡Œï¼Œçœ‹é‡Œé¢çš„ä¸‰ä¸ªå­—æ®µï¼š
1. Request Methodï¼šè¯·æ±‚æ–¹æ³•ï¼Œè¿™é‡Œçš„è¯·æ±‚æ–¹æ³•æ˜¯HEADï¼Œç”¨æ¥è·å–æŠ¥æ–‡é¦–éƒ¨
2. Request URIï¼šè¯·æ±‚çš„URLï¼Œå› ä¸ºæˆ‘ä»¬æ²¡æŒ‡å®šï¼Œæ‰€ä»¥é»˜è®¤æ˜¯/
3. Request Versionï¼šè¯·æ±‚çš„ç‰ˆæœ¬ï¼Œå› ä¸ºç”¨çš„æ˜¯HTTPåè®®ï¼Œæ‰€ä»¥è¿™é‡Œæ˜¾ç¤ºHTTPåè®®çš„ç‰ˆæœ¬

è¯·æ±‚å¤´éƒ¨åˆ†ï¼š
Hostï¼šç›®æ ‡ä¸»æœº
User-Agentï¼šä»£ç†ï¼Œä¹Ÿå°±æ˜¯æµè§ˆå™¨çš„ç±»å‹ã€‚æˆ‘ä»¬ç”¨çš„ä¸æ˜¯æµè§ˆå™¨ï¼Œæ‰€ä»¥è¿™é‡Œæ˜¾ç¤ºçš„æ˜¯å‘½ä»¤curl
Acceptï¼šæµè§ˆå™¨å¯æ¥å—çš„MIMEç±»å‹

##### å“åº”æŠ¥æ–‡
![](https://s2.loli.net/2024/03/27/4zVGmdrfe7oDPjE.png)
çŠ¶æ€è¡Œï¼šåŒ…å«ç‰ˆæœ¬å’Œå“åº”çŠ¶æ€ç ã€çŠ¶æ€ä¿¡æ¯
å“åº”å¤´ï¼šåŒ…å«å“åº”çš„æœåŠ¡å™¨çš„èµ„æºä¿¡æ¯ï¼Œä¸€è¡Œä¸€ä¸ªå“åº”å¤´ 

ç‚¹å¼€çŠ¶æ€è¡Œï¼Œå¯ä»¥çœ‹åˆ°é‡Œé¢æœ‰ä¸‰ä¸ªå­—æ®µï¼š
![](https://s2.loli.net/2024/03/27/bpDYtwJyr2Uu3ij.png)
1. Response Versionï¼šå“åº”ç‰ˆæœ¬ï¼Œå› ä¸ºä½¿ç”¨çš„æ˜¯HTTPåè®®ï¼Œæ‰€ä»¥è¿™é‡Œæ˜¾ç¤ºäº†HTTPçš„ç‰ˆæœ¬
2. Status Codeï¼šå“åº”çŠ¶æ€ç ï¼Œè¿™é‡Œçš„ 200 è¡¨ç¤ºè¯·æ±‚æˆåŠŸã€‚
3. Response Phraseï¼šå“åº”çŠ¶æ€ç çš„æç¤ºä¿¡æ¯

å¦å¤–å“åº”å¤´ï¼š
{% note info modern %}
Dateï¼šæœåŠ¡ç«¯å‘é€å“åº”æŠ¥æ–‡çš„æ—¶é—´
Serverï¼šæœåŠ¡å™¨å’Œç›¸å¯¹åº”çš„ç‰ˆæœ¬
Last-Modifiedï¼šè¯·æ±‚çš„å¯¹è±¡åˆ›å»ºæˆ–è€…æœ€åä¿®æ”¹çš„æ—¶é—´
ETagï¼šå¯¹è±¡çš„æ ‡å¿—å€¼ï¼Œå¦‚æœå¯¹è±¡ä¿®æ”¹äº†ï¼Œè¿™ä¸ªå€¼ä¹Ÿä¼šå˜ï¼Œç”¨æ¥åˆ¤æ–­å¯¹è±¡æ˜¯å¦æ”¹å˜
Accept-Rangesï¼šæ”¯æŒçš„èŒƒå›´å•ä½
Content-Lengthï¼šå†…å®¹é•¿åº¦
Cache-Controlï¼šç¼“å­˜æ§åˆ¶
Expiresï¼šè¿™ä¸ªæ—¶é—´å‰ï¼Œå¯ä»¥ç›´æ¥è®¿é—®ç¼“å­˜å‰¯æœ¬
Connectionï¼šè¿æ¥ç±»å‹ï¼ŒKeep-Aliveè¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªé•¿é“¾æ¥ï¼Œå¯ä»¥ç»§ç»­ç”¨è¿™ä¸ªè¿æ¥é€šä¿¡
Content-Typeï¼šèµ„æºæ–‡ä»¶ç±»å‹
{% endnote %}

##### HTTPè¿½è¸ªæµ
é€‰ä¸­HTTPåè®®çš„æ•°æ®åŒ… - å³é”® - ã€è¿½è¸ªæµã€‘-ã€HTTPè¿½è¸ªæµã€‘å¯ä»¥çœ‹åˆ°è¯·æ±‚è·Ÿå“åº”çš„æŠ¥æ–‡
![](https://s2.loli.net/2024/03/27/IxFOwLWZTRcuNUC.png)


## é»‘å®¢åˆ©ç”¨wiresharkæ¥è·å–ç”¨æˆ·è´¦å·å¯†ç 
è¯¦ç»†æµ‹è¯•è¿‡ç¨‹è¯·è‡ªè¡Œæœç´¢ï¼Œæˆ‘ä¹Ÿåœ¨å­¦ä¹ è¿‡ç¨‹ä¸­
è¿™æ˜¯æˆ‘è‡ªå·±æ‰¾çš„ä¸€ä¸ªæ•™ç¨‹ï¼š

{% link WiresharkæŠ“å–ç½‘ç«™ç”¨æˆ·åå¯†ç , https://www.cnblogs.com/thespace/p/12731638.html %}

æœ€åæƒ³è¯´çš„å°±æ˜¯è¦æ³¨æ„äº’è”ç½‘å®‰å…¨ï¼